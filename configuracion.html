<!DOCTYPE html>
<html lang="es">
<head>
  <!--estilos css-->

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css">
  <link rel="stylesheet" href="css/styles.css">

<!-- fin de los estilos css-->
  <meta charset="UTF-8">
  <title>Configuraci√≥n ¬∑ MRS TPV</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css">
</head>
<body>

  <div id="topbar-app"></div>

<main class="container">
  <div class="settings-layout">
    
    <aside class="settings-sidebar">
      <h5 class="settings-sidebar-title">Ajustes</h5>
      <button onclick="switchTab('empresa', this)" class="active">üè¢ Empresa</button>
      <button onclick="switchTab('documentos', this)">üßæ Documentos</button>
      <button onclick="switchTab('catalogo', this)">üìÇ Cat√°logo</button>
      <button onclick="switchTab('temas', this)">üé® Temas e Interfaz</button>
      <button class="primary settings-sidebar-cta" onclick="guardarPanelPro()">üíæ Guardar Cambios</button>
    </aside>

    <div class="settings-main">
      <header class="settings-main-header">
        <div>
          <h2 class="settings-main-title">Panel de configuraci√≥n</h2>
          <p class="settings-main-subtitle">Gestiona datos de empresa, documentos, cat√°logo y temas.</p>
        </div>
        <div class="settings-main-actions">
          <button class="secondary" type="button" onclick="location.reload()">Recargar</button>
          <button class="primary" type="button" onclick="guardarPanelPro()">Guardar</button>
        </div>
      </header>

      <section id="catalogo" class="tab-section">
        <article class="settings-card">
          <p class="settings-main-subtitle">Gestiona familias, productos y stock desde un √∫nico panel din√°mico.</p>
          
          <h4>üìÅ Familias</h4>
          <div style="background: #f8fafc; padding: 15px; border-radius: 10px; border: 1px solid var(--border-color);">
            <input type="hidden" id="cat-id-edit"> 
            <label>Nombre</label>
            <input id="cat-nombre" placeholder="Ej: Fundas">
            <label>Fiscal</label>
            <select id="cat-fiscal">
              <option value="IVA">Solo IVA (Servicios)</option>
            </select>
            <label style="font-size: 0.75rem;">Imagen (opcional)
              <input type="file" id="cat-img" accept="image/*">
            </label>
            <div style="display: flex; gap: 5px; margin-top: 10px;">
              <button id="btn-cat-guardar" class="outline" onclick="crearCategoria()" style="flex: 2; margin: 0; font-size: 0.8rem;">Crear/Guardar</button>
              <button id="btn-cat-cancelar" onclick="limpiarFormCat()" style="flex: 1; display: none; background: #ff4d4d; border: none; margin: 0;">‚úñ</button>
            </div>
          </div>
          <ul id="lista-categorias-config"></ul>

          <hr>
          <h4>üì¶ Productos</h4>
          <div style="display:flex; flex-direction:column; align-items:center; gap: 16px;">
            <div style="min-width:140px; display:flex; flex-direction:column; align-items:center;">
              <img id="prod-preview" src="" alt="" style="width:140px; height:140px; object-fit:cover; border:1px solid var(--border-color); border-radius:8px; display:none;">
              <label style="margin-top:8px;">Cambiar imagen
                <input type="file" id="prod-img" accept="image/*">
              </label>
              <div class="input-group" style="max-width:520px; width:100%; margin-top:12px;">
                <input id="prod-nombre" placeholder="T√≠tulo / Nombre del producto" class="span-2">
                <select id="prod-cat-select">
                  <option value="">Selecciona Familia...</option>
                </select>
                <input id="prod-marca" placeholder="Marca">
                <input id="prod-modelo" placeholder="Modelo">
                <input id="prod-color" placeholder="Color">
                <div style="display:flex; gap:8px; align-items:center;">
                  <input id="prod-barras" placeholder="C√≥d. Barras" style="flex:1;">
                  <button class="outline" type="button" onclick="generarCodigoBarras()">Generar</button>
                </div>
                <input id="prod-ref" placeholder="N¬∫ Referencia">
                <input id="prod-almacen" placeholder="Ubicaci√≥n / Almacenamiento">
                <label>Precio de compra
                  <input type="number" id="prod-compra" step="0.01" placeholder="0.00">
                </label>
                <label>Precio de venta
                  <input type="number" id="prod-venta" step="0.01" placeholder="0.00">
                </label>
                <select id="prod-proveedor">
                  <option value="">Proveedor</option>
                </select>
                <label>Stock m√≠nimo
                  <input type="number" id="prod-stock-min" step="1" placeholder="0">
                </label>
                <div style="display:flex; gap:8px; align-items:center;">
                  <button class="outline" type="button" onclick="ajustarUnidades(-1)">‚àí</button>
                  <input type="number" id="prod-unidades" step="1" value="0" style="width:100px; text-align:center;">
                  <button class="outline" type="button" onclick="ajustarUnidades(1)">+</button>
                </div>
                <textarea id="prod-obs" rows="2" placeholder="Observaciones"></textarea>
              </div>
              <button style="width: 100%; max-width:520px; margin-top: 12px;" onclick="guardarProducto()">üíæ Guardar Producto</button>
            </div>
          </div>
          
          <div class="prod-table-container" style="margin-top: 12px;">
            <table>
              <thead>
                <tr>
                  <th>Nombre</th>
                  <th>PVP</th>
                  <th>Stock</th>
                  <th>Familia</th>
                  <th></th>
                </tr>
              </thead>
              <tbody id="tabla-productos-body">
                </tbody>
            </table>
          </div>

          <hr>
          <h4>üì¶ Inventario</h4>
          <div class="input-group" style="gap:8px;">
            <select id="inv-cat-filter">
              <option value="">Todas las familias</option>
            </select>
          </div>
          <div class="prod-table-container">
            <table>
              <thead>
                <tr>
                  <th>Producto</th>
                  <th>Unidades</th>
                  <th>Stock m√≠nimo</th>
                  <th>Ubicaci√≥n</th>
                  <th>Ajustar</th>
                </tr>
              </thead>
              <tbody id="tabla-inventario-body">
                </tbody>
            </table>
          </div>
        </article>
      </section>

      <section id="empresa" class="tab-section active">
        <article class="settings-card">
          <h3>Datos de Empresa</h3>
          <p class="settings-main-subtitle">Completa la informaci√≥n fiscal y de contacto que se mostrar√° en tickets, facturas y navbar.</p>
          <div class="input-group">
            <input id="nombre" placeholder="Nombre comercial">
            <input id="razon" placeholder="Raz√≥n social">
            <input id="cif" placeholder="CIF/NIF">
            <input id="telefono" placeholder="Tel√©fono">
            <input id="email" placeholder="Email de contacto" class="span-2">
            <input id="direccion" placeholder="Direcci√≥n completa" class="span-2">
          </div>
          <hr>
          <label>Logotipo Corporativo
            <input type="file" id="logo" accept="image/*">
          </label>
          <img id="logo-preview" style="display:none; max-width:180px; border-radius: 10px; margin-top:10px;">
        </article>
      </section>

      <section id="documentos" class="tab-section">
        <article class="settings-card">
          <h3>Configuraci√≥n de Impresi√≥n</h3>
          <p class="settings-main-subtitle">Elige qu√© datos de la empresa se imprimen en tickets y facturas, y personaliza el pie legal.</p>
          <div class="input-group" style="background: #f9fafb; padding: 20px; border-radius: 10px;">
            <label><input type="checkbox" id="doc-logo"> Logo</label>
            <label><input type="checkbox" id="doc-cif"> CIF</label>
            <label><input type="checkbox" id="doc-razon"> Raz√≥n Social</label>
            <label><input type="checkbox" id="doc-direccion"> Direcci√≥n</label>
            <label><input type="checkbox" id="doc-telefono"> Tel√©fono</label>
            <label><input type="checkbox" id="doc-email"> Email</label>
            <label><input type="checkbox" id="doc-web"> Web</label>
            <label><input type="checkbox" id="doc-pago"> Modo Pago</label>
          </div>
          <br>
          <textarea id="pie" rows="4" placeholder="Pie de p√°gina legal..."></textarea>
        </article>
      </section>

      <section id="temas" class="tab-section">
        <article class="settings-card">
          <h3>Personalizaci√≥n del Sistema</h3>
          <p class="settings-main-subtitle">Ajusta el color principal y el modo de pantalla de la aplicaci√≥n.</p>
          <label style="margin-top:6px;"><input type="checkbox" id="nav-mostrar-logo"> Mostrar logo en barra superior</label>
          
          <hr>
          <h5>Perfil de Color</h5>
          <div class="theme-preview">
            <div class="theme-dot" style="background: #3b82f6;" onclick="setTheme('#3b82f6')"></div>
            <div class="theme-dot" style="background: #10b981;" onclick="setTheme('#10b981')"></div>
            <div class="theme-dot" style="background: #ef4444;" onclick="setTheme('#ef4444')"></div>
            <div class="theme-dot" style="background: #8b5cf6;" onclick="setTheme('#8b5cf6')"></div>
            <div class="theme-dot" style="background: #f59e0b;" onclick="setTheme('#f59e0b')"></div>
          </div>
          <br>
          <label>O elige un color personalizado:
            <input type="color" id="color" oninput="setTheme(this.value)">
          </label>

          <hr>
          <h5>Modo de Pantalla</h5>
          <select id="tema" onchange="cambiarModo(this.value)">
            <option value="claro">‚òÄÔ∏è Modo Claro</option>
            <option value="oscuro">üåô Modo Noche</option>
          </select>
        </article>
      </section>

    </div>
  </div>
</main>

<script>
  function switchTab(tabId, btn) {
    document.querySelectorAll('.tab-section').forEach(s => s.classList.remove('active'));
    document.querySelectorAll('.settings-sidebar button').forEach(b => b.classList.remove('active'));
    document.getElementById(tabId).classList.add('active');
    btn.classList.add('active');
  }

  function setTheme(color) {
    document.documentElement.style.setProperty('--accent', color);
    const colorInput = document.getElementById('color');
    if(colorInput) colorInput.value = color;
  }

  function cambiarModo(modo) {
    if(modo === 'oscuro') {
      document.documentElement.style.setProperty('--bg-app', '#1a202c');
      document.documentElement.style.setProperty('--bg-card', '#2d3748');
      document.documentElement.style.setProperty('--text-main', '#f7fafc');
      document.documentElement.style.setProperty('--border-color', '#4a5568');
    } else {
      document.documentElement.style.setProperty('--bg-app', '#f4f7f9');
      document.documentElement.style.setProperty('--bg-card', '#ffffff');
      document.documentElement.style.setProperty('--text-main', '#2d3748');
      document.documentElement.style.setProperty('--border-color', '#e2e8f0');
    }
  }
</script>

<script src="js/topbar.js" type="module"></script>
<script type="module" src="js/config-panel-pro.js"></script>

</body>
</html>
